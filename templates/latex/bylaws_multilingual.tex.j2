((#
  # Template for a LaTeX regulation
  #
  # Since LaTeX does not play nicely with {% %}, use ((* *))
  #))

((* from "macros.tex.j2" import header, section_bilingual, article_mononlingual, set_multilingual_title with context *))

\documentclass[monolingual=false]{assets/latex/vseth-bylaws}
\setdate{(( bylaws.date_last_update | format_date ))}

\begin{document}
\selectlanguage{nswissgerman}
\maketitlepage{(( set_multilingual_title(bylaws.title) | escape_tex ))}{((bylaws.date_last_update | format_date))}

\tableofcontents

((* for regl in bylaws.regulations *))
  ((* set shortid *))
    ((*- if regl.abbrev is not none -*))(( regl.abbrev | escape_tex )); ((* endif *))(( regl.id | escape_tex -))
  ((* endset *))
  ((* set subtitle *))
    ((*- if regl.short[GLOBAL_LANGUAGE] is not none -*))(( set_multilingual_title(regl.short) | escape_tex ))((*- endif -*))
    ((*- if regl.short[GLOBAL_LANGUAGE] is not none and regl.abbrev[GLOBAL_LANGUAGE] is not none -*)); ((* endif *))
    ((*- if regl.abbrev[GLOBAL_LANGUAGE] is not none -*))(( set_multilingual_title(regl.abbrev) | escape_tex ))((*- endif -*))
  ((* endset *))
  ((* if regl.short[GLOBAL_LANGUAGE] is not none *))
    \chapter*{(( set_multilingual_title(regl.title) | escape_tex ))}
    \vspace*{-0.5cm}
    {\usekomafont{subtitle} ((- subtitle )); RSVSS (( shortid | escape_tex -))}
    \addtocentrydefault{chapter}{}{(( set_multilingual_title(regl.short) | escape_tex )) (RSVSS (( shortid | escape_tex -)) )}
  ((* else *))
    \chapter*{(( set_multilingual_title(regl.title) | escape_tex ))}
    \vspace*{-0.5cm}
    {\usekomafont{subtitle} RSVSETH (( shortid | escape_tex -))}
    \addtocentrydefault{chapter}{}{(( set_multilingual_title(regl.title) | escape_tex )) (RSVSS (( shortid | escape_tex -)) )}
  ((* endif *))
  \stepcounter{chapter}
  
  ((* if regl.preamble is defined *))
    \emph{((- set_text(regl.preamble.text) -))(( changeFootnoteMark(regl.preamble.changeFootnote) ))(( changeFootnote(regl.preamble.changeFootnote) ))}
  ((* endif *))

  ((* for art in regl.articles -*))
    ((- article_multiling(art, ["de", "fr"]) ))
  ((* endfor *))
  ((* for sec in regl.sections -*))
    ((- section_bilingual(sec, ["de", "fr"]) -))
  ((* endfor *))
((* endfor *))
\end{document}